{% load static %}
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>Link Data | Finnovate</title>
    <link rel="stylesheet" href="{% static 'base.css' %}" />
    <link rel="icon" type="image/x-icon" href="{% static 'favicon.png' %}">
    <style>
      .tableauPlaceholder {
        width: 95%;
        height: 90vh;
        border-radius: 12px;
        overflow: hidden;
        box-shadow: 0 0 20px rgba(0,0,0,0.1);
      }

      main {
        margin: 0;
        padding: 2rem;
        overflow-y: scroll;
        scrollbar-width: thin;
      }
    </style>
  </head>

  <body>
    {% include 'base/navbar.html' %}
    <main>
      <div class="grid"></div>

      <!-- Tableau Dashboard Embed -->
      <div class="tableauPlaceholder" id="vizDashboard" style="position: relative">
        <noscript>
          <a href="#">
            <img alt="Dashboard 1"
              src="https://public.tableau.com/static/images/da/dashboard12_17625229633570/Dashboard1/1_rss.png"
              style="border: none" />
          </a>
        </noscript>

        <object class="tableauViz" style="display:none;">
          <param name="host_url" value="https%3A%2F%2Fpublic.tableau.com%2F" />
          <param name="embed_code_version" value="3" />
          <param name="site_root" value="" />
          <param name="name" value="dashboard12_17625229633570/Dashboard1" />
          <param name="tabs" value="no" />
          <param name="toolbar" value="yes" />
          <param name="static_image"
            value="https://public.tableau.com/static/images/da/dashboard12_17625229633570/Dashboard1/1.png" />
          <param name="animate_transition" value="yes" />
          <param name="display_static_image" value="yes" />
          <param name="display_spinner" value="yes" />
          <param name="display_overlay" value="yes" />
          <param name="display_count" value="yes" />
          <param name="language" value="en-US" />
          <param name="filter" value="publish=yes" />
        </object>
      </div>
    </main>

    {% include 'base/footer.html' %}

    <script type="text/javascript">
      // Tableau embed logic
      var divElement = document.getElementById('vizDashboard');
      var vizElement = divElement.getElementsByTagName('object')[0];
      if (divElement.offsetWidth > 800) {
        vizElement.style.minWidth = '1420px';
        vizElement.style.maxWidth = '1720px';
        vizElement.style.width = '100%';
        vizElement.style.minHeight = '787px';
        vizElement.style.maxHeight = '1087px';
        vizElement.style.height = (divElement.offsetWidth * 0.75) + 'px';
      } else {
        vizElement.style.width = '100%';
        vizElement.style.height = '1427px';
      }

      var scriptElement = document.createElement('script');
      scriptElement.src = 'https://public.tableau.com/javascripts/api/viz_v1.js';
      vizElement.parentNode.insertBefore(scriptElement, vizElement);

      // ðŸ”„ AUTO REFRESH every 15 minutes for dynamic updates
      setInterval(() => {
        console.log("Refreshing Tableau dashboard...");
        location.reload();
      }, 15 * 60 * 1000); // 15 minutes
    </script>
  </body>
</html>

